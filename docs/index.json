[
{
	"uri": "/tutorials-4/line-plot/",
	"title": "Line plot for time series data",
	"tags": [],
	"description": "",
	"content": " pre code, pre, code { white-space: pre !important; overflow-x: scroll !important; word-break: keep-all !important; word-wrap: initial !important; }  Import data load(url(\u0026#39;https://github.com/MingChen0919/gst-colloquium-workshop-2018/raw/master/content/datasets/datasets.RData\u0026#39;))  Load libraries library(ggplot2) library(gridExtra)  Visualization Feature against frame index  Geom object: line  frame_index -\u0026gt; x feature -\u0026gt; y   # ggplot2 template p1 = ggplot(data = trajectory) + geom_line(mapping = aes(x = frame_index/1000, y = trajectory[, 2]), stat = \u0026quot;identity\u0026quot;, position = \u0026quot;identity\u0026quot;, color = \u0026#39;#ff6d6d\u0026#39;) + coord_cartesian() + facet_null() + #----map data values to visual values--- scale_x_continuous(name = \u0026quot;Frame index\u0026quot;) + scale_y_continuous(name = colnames(trajectory[2])) + theme_classic() p1  Distribution of feature values  Geom object: density  feature -\u0026gt; x   # ggplot2 template p2 = ggplot(data = trajectory) + geom_density(mapping = aes(x = trajectory[, 2]), stat = \u0026quot;density\u0026quot;, position = \u0026quot;identity\u0026quot;, color = \u0026#39;#3dbfff\u0026#39;) + coord_flip() + facet_null() + #----map data values to visual values--- scale_x_continuous(name = colnames(trajectory)[2]) + theme_classic() p2  Combine time series plot and density plot grid.arrange(p1, p2, ncol = 2, widths = c(3,1)) # overwrite xlab on density plot. grid.arrange(p1, p2 + xlab(\u0026#39;\u0026#39;), ncol = 2, widths = c(3,1))   All features in one plots Define your own plotting functions\nline_plot = function(col_n) { p = ggplot(data = trajectory) + geom_line(mapping = aes(x = frame_index/1000, y = trajectory[, col_n]), stat = \u0026quot;identity\u0026quot;, position = \u0026quot;identity\u0026quot;, color = \u0026#39;#ff6d6d\u0026#39;) + coord_cartesian() + facet_null() + scale_x_continuous() + scale_y_continuous() + theme_classic() + theme(axis.title=element_text(size=5,face=\u0026quot;bold\u0026quot;)) + # helper functions xlab(\u0026#39;Frame Index\u0026#39;) + ylab(colnames(trajectory)[col_n]) return(p) } density_plot = function(col_n) { p = ggplot(data = trajectory) + geom_density(mapping = aes(x = trajectory[, col_n]), stat = \u0026quot;density\u0026quot;, position = \u0026quot;identity\u0026quot;, color = \u0026#39;#3dbfff\u0026#39;) + coord_flip() + facet_null() + scale_x_continuous() + theme_classic() + theme(axis.title=element_text(size=5,face=\u0026quot;bold\u0026quot;)) + # helper functions xlab(\u0026#39;\u0026#39;) return(p) } Examples\nline_plot(2) density_plot(4) Plots vector all_plots = list() for (i in 1:58) { # get column number col_n = (i + 1) %/% 2 + 1 cat(\u0026#39;The column number is: \u0026#39;, col_n, \u0026#39;\\n\u0026#39;) if (i %% 2 == 1) { cat(\u0026#39;i is an odd number: i = \u0026#39;, i, \u0026#39;\\n\u0026#39;) all_plots[[i]] = line_plot(col_n) } else { cat(\u0026#39;i is an even number: i = \u0026#39;, i, \u0026#39;\\n\u0026#39;) all_plots[[i]] = density_plot(col_n) } cat(\u0026#39;----------------------------------\\n\u0026#39;) } ## The column number is: 2 ## i is an odd number: i = 1 ## ---------------------------------- ## The column number is: 2 ## i is an even number: i = 2 ## ---------------------------------- ## The column number is: 3 ## i is an odd number: i = 3 ## ---------------------------------- ## The column number is: 3 ## i is an even number: i = 4 ## ---------------------------------- ## The column number is: 4 ## i is an odd number: i = 5 ## ---------------------------------- ## The column number is: 4 ## i is an even number: i = 6 ## ---------------------------------- ## The column number is: 5 ## i is an odd number: i = 7 ## ---------------------------------- ## The column number is: 5 ## i is an even number: i = 8 ## ---------------------------------- ## The column number is: 6 ## i is an odd number: i = 9 ## ---------------------------------- ## The column number is: 6 ## i is an even number: i = 10 ## ---------------------------------- ## The column number is: 7 ## i is an odd number: i = 11 ## ---------------------------------- ## The column number is: 7 ## i is an even number: i = 12 ## ---------------------------------- ## The column number is: 8 ## i is an odd number: i = 13 ## ---------------------------------- ## The column number is: 8 ## i is an even number: i = 14 ## ---------------------------------- ## The column number is: 9 ## i is an odd number: i = 15 ## ---------------------------------- ## The column number is: 9 ## i is an even number: i = 16 ## ---------------------------------- ## The column number is: 10 ## i is an odd number: i = 17 ## ---------------------------------- ## The column number is: 10 ## i is an even number: i = 18 ## ---------------------------------- ## The column number is: 11 ## i is an odd number: i = 19 ## ---------------------------------- ## The column number is: 11 ## i is an even number: i = 20 ## ---------------------------------- ## The column number is: 12 ## i is an odd number: i = 21 ## ---------------------------------- ## The column number is: 12 ## i is an even number: i = 22 ## ---------------------------------- ## The column number is: 13 ## i is an odd number: i = 23 ## ---------------------------------- ## The column number is: 13 ## i is an even number: i = 24 ## ---------------------------------- ## The column number is: 14 ## i is an odd number: i = 25 ## ---------------------------------- ## The column number is: 14 ## i is an even number: i = 26 ## ---------------------------------- ## The column number is: 15 ## i is an odd number: i = 27 ## ---------------------------------- ## The column number is: 15 ## i is an even number: i = 28 ## ---------------------------------- ## The column number is: 16 ## i is an odd number: i = 29 ## ---------------------------------- ## The column number is: 16 ## i is an even number: i = 30 ## ---------------------------------- ## The column number is: 17 ## i is an odd number: i = 31 ## ---------------------------------- ## The column number is: 17 ## i is an even number: i = 32 ## ---------------------------------- ## The column number is: 18 ## i is an odd number: i = 33 ## ---------------------------------- ## The column number is: 18 ## i is an even number: i = 34 ## ---------------------------------- ## The column number is: 19 ## i is an odd number: i = 35 ## ---------------------------------- ## The column number is: 19 ## i is an even number: i = 36 ## ---------------------------------- ## The column number is: 20 ## i is an odd number: i = 37 ## ---------------------------------- ## The column number is: 20 ## i is an even number: i = 38 ## ---------------------------------- ## The column number is: 21 ## i is an odd number: i = 39 ## ---------------------------------- ## The column number is: 21 ## i is an even number: i = 40 ## ---------------------------------- ## The column number is: 22 ## i is an odd number: i = 41 ## ---------------------------------- ## The column number is: 22 ## i is an even number: i = 42 ## ---------------------------------- ## The column number is: 23 ## i is an odd number: i = 43 ## ---------------------------------- ## The column number is: 23 ## i is an even number: i = 44 ## ---------------------------------- ## The column number is: 24 ## i is an odd number: i = 45 ## ---------------------------------- ## The column number is: 24 ## i is an even number: i = 46 ## ---------------------------------- ## The column number is: 25 ## i is an odd number: i = 47 ## ---------------------------------- ## The column number is: 25 ## i is an even number: i = 48 ## ---------------------------------- ## The column number is: 26 ## i is an odd number: i = 49 ## ---------------------------------- ## The column number is: 26 ## i is an even number: i = 50 ## ---------------------------------- ## The column number is: 27 ## i is an odd number: i = 51 ## ---------------------------------- ## The column number is: 27 ## i is an even number: i = 52 ## ---------------------------------- ## The column number is: 28 ## i is an odd number: i = 53 ## ---------------------------------- ## The column number is: 28 ## i is an even number: i = 54 ## ---------------------------------- ## The column number is: 29 ## i is an odd number: i = 55 ## ---------------------------------- ## The column number is: 29 ## i is an even number: i = 56 ## ---------------------------------- ## The column number is: 30 ## i is an odd number: i = 57 ## ---------------------------------- ## The column number is: 30 ## i is an even number: i = 58 ## ---------------------------------- all_plots$ncol = 6 all_plots$widths = c(5,2,5,2,5,2) do.call(grid.arrange, all_plots)   "
},
{
	"uri": "/rstudio-accounts-1/",
	"title": "RStudio Accounts",
	"tags": [],
	"description": "",
	"content": " pre code, pre, code { white-space: pre !important; overflow-x: scroll !important; word-break: keep-all !important; word-wrap: initial !important; }  Workshop Environment RStudio Server Account\nSelect an user account from this google sheet and put your name on the right to mark that this user account has been used.\nUse the upload button to upload local files to the Server.\nInstall packages (optional) You can use the code below to install R packages in the RStudio server.\ndir.create(\u0026#39;~/my-r-lib\u0026#39;) .libPaths(\u0026#39;~/my-r-lib\u0026#39;) install.packages(\u0026#39;ggplot2\u0026#39;)   Build Workshop Environment (admin users only) RStudio Docker on Jetstream Launch a Jetstream image with Docker installed on Jetstream. Then run the following to luanch an RStudio server.\nsudo su # docker pull rocker/rstudio # docker run --name=gst_dv -d -p 80:8787 rocker/rstudio docker pull mingchen0919/gst-dv-rstudio docker run --name=gst_dv -d -p 80:8787 mingchen0919/gst-dv-rstudio  Create 30 new users # login to the rstudio container docker exec -it gst_dv bash # create users in the rstudio container for id in $(seq 1 30) do echo \u0026quot;gst_user_${id}:passwd_user_${id}::::/home/gst_user_${id}:\u0026quot; | newusers done   "
},
{
	"uri": "/datasets-2/",
	"title": "Datasets",
	"tags": [],
	"description": "",
	"content": " pre code, pre, code { white-space: pre !important; overflow-x: scroll !important; word-break: keep-all !important; word-wrap: initial !important; }  Dataset descriptions Time series plot datasets: trajectory  dimension: 5001 rows x 30 columns column 1: frame indices, from 1 to 5001. column 2-30: feature values from molecular simulation.  Below is the first few rows and columns of trajectory:\ntrajectory[1:10, 1:4] ## frame_index DIST: TRP 1 CA 3 - LEU 2 CA 27 DIST: TRP 1 CA 3 - ALA 3 CA 46 DIST: TRP 1 CA 3 - LEU 4 CA 56 ## 1 1 0.390 0.663 0.931 ## 2 2 0.391 0.676 0.946 ## 3 3 0.386 0.683 0.934 ## 4 4 0.389 0.648 1.001 ## 5 5 0.390 0.673 0.954 ## 6 6 0.377 0.702 0.862 ## 7 7 0.383 0.680 0.958 ## 8 8 0.391 0.654 0.937 ## 9 9 0.382 0.632 0.861 ## 10 10 0.392 0.704 0.918  PCA plot datasets: energy_tics This data is the dimension-reduced trajectory. We used a PCA-like method to analyze the feature trajectory, which tells us vectors (called collective variables, CVs) that explain the pattern of how all the feature values change. A good example for thinking about this would be that you have a protein with a large and slow open-close motion. The open/close motion should be the first CV, so this vector is the change in feature values when the protein opens and closes. Say the CV points in the ‘opening’ direction, then if the protein is closed the coordinate in this CV would be 0 or small. As you add more of the vector to the feature values, the coordinate would grow to open the protein. This way, we only need a single number for each frame to tell us how open or closed the protein is. Typically, 3-5 CVs will replace hundreds of feature values, since each CV encodes something that happens to all the features. In this case, the CV’s are called TICs. Then we cluster the frames in their CV coordinates into a big and a small groups called microstates and macrostates, respectively.\n dimension: 5001 rows x 8 columns column 1: frame indices, from 1 to 5001. column 2: energy column. It isa rough estimate of the protein’s internal energy in each frame. column 3-6: collective variables columns (CVs). column 7: microstates column 8: macrostates.  head(energy_tics) ## frame_index Energy TIC0 TIC1 TIC2 TIC3 macrostate ## 1 1 3.5432057 0.02972381 -0.52648097 -0.22878167 0.08876710 1 ## 2 2 6.3508859 0.66341269 -0.30123132 0.22007662 -0.30957389 1 ## 3 3 3.5261111 0.16165309 -0.16548754 -0.28634939 0.14749396 1 ## 4 4 0.0000000 -0.18048114 0.05328040 0.09536493 0.07265779 1 ## 5 5 8.2967958 1.47613239 -1.24254990 0.25970548 0.13562503 1 ## 6 6 0.7471867 0.02660624 0.06427059 0.27882308 -0.02626531 1   "
},
{
	"uri": "/tutorials-4/pca/",
	"title": "Scatterplot for PCA data",
	"tags": [],
	"description": "",
	"content": " pre code, pre, code { white-space: pre !important; overflow-x: scroll !important; word-break: keep-all !important; word-wrap: initial !important; }  Import data load(url(\u0026#39;https://github.com/MingChen0919/gst-colloquium-workshop-2018/raw/master/content/datasets/datasets.RData\u0026#39;))  Load libraries library(ggplot2)  Visualization Collective Variables and Macrostates  Geom object: point  TIC0 -\u0026gt; x TIC1 -\u0026gt; y macrostate -\u0026gt; color   ggplot(energy_tics) + geom_point(mapping = aes(x = TIC0, y = TIC1, color = as.factor(macrostate)), stat = \u0026quot;identity\u0026quot;, position = \u0026quot;identity\u0026quot;) + coord_cartesian() + facet_null() + #----map data values to visual values--- scale_x_continuous() + scale_y_continuous() + scale_color_identity() + theme() ggplot(energy_tics) + geom_point(mapping = aes(x = TIC0, y = TIC1, color = as.factor(macrostate)), stat = \u0026quot;identity\u0026quot;, position = \u0026quot;identity\u0026quot;) + coord_cartesian() + facet_null() + ##----map data values to visual values--- scale_x_continuous(name = \u0026quot;TIC-0\u0026quot;, breaks = c(-1, 0, 1, 2, 3, 4, 5, 6, 7), limits = c(-2, 10)) + scale_y_continuous(name = \u0026quot;TIC-1\u0026quot;, breaks = -6:3, trans = \u0026quot;reverse\u0026quot;) + scale_color_manual(values = c(\u0026quot;1\u0026quot; = \u0026quot;red\u0026quot;, \u0026quot;2\u0026quot; = \u0026quot;blue\u0026quot;, \u0026quot;3\u0026quot; = \u0026quot;yellow\u0026quot;, \u0026quot;4\u0026quot; = \u0026quot;green\u0026quot;), name = \u0026quot;Macrostate\u0026quot;, breaks = c(1,2,3), labels = c(\u0026#39;state 1\u0026#39;, \u0026#39;state 2\u0026#39;, \u0026#39;state 3\u0026#39;)) + theme_classic()  Collective Variables, macrostate and Energy  Geom object: point  TIC0 -\u0026gt; x TIC1 -\u0026gt; y macrostate -\u0026gt; shape Energy -\u0026gt; color   ggplot(energy_tics) + geom_point(mapping = aes(x = TIC0, y = TIC1, shape = as.factor(macrostate), color = Energy), stat = \u0026quot;identity\u0026quot;, position = \u0026quot;identity\u0026quot;) + coord_cartesian() + facet_null() + ##----map data values to visual values--- scale_x_continuous() + scale_y_continuous() + scale_color_gradient() + scale_shape_discrete() + theme() ggplot(energy_tics) + geom_point(mapping = aes(x = TIC0, y = TIC1, shape = as.factor(macrostate), color = Energy), stat = \u0026quot;identity\u0026quot;, position = \u0026quot;identity\u0026quot;) + coord_cartesian() + facet_null() + ##----map data values to visual values--- scale_x_continuous(name = \u0026quot;TIC-0\u0026quot;, breaks = -1:8) + scale_y_continuous(name = \u0026quot;TIC-1\u0026quot;, breaks = -6:3) + scale_color_gradient(low=\u0026quot;blue\u0026quot;, high=\u0026quot;red\u0026quot;, breaks = 0:8) + scale_shape_manual(values = c(\u0026quot;1\u0026quot; = 15, \u0026quot;2\u0026quot; = 17, \u0026quot;3\u0026quot; = 19, \u0026quot;4\u0026quot; = 22), name = \u0026quot;Macrostate\u0026quot;) + theme_classic()   Confidence ellipse  Geom object: point  TIC0 -\u0026gt; x TIC1 -\u0026gt; y macrostate -\u0026gt; shape Energy -\u0026gt; color  Geom object: path  TIC0 -\u0026gt; x TIC1 -\u0026gt; y macrostate -\u0026gt; color   ggplot(energy_tics) + geom_point(mapping = aes(x = TIC0, y = TIC1, color = Energy), stat = \u0026quot;identity\u0026quot;, position = \u0026quot;identity\u0026quot;, inherit.aes = FALSE) + geom_path(mapping = aes(x = TIC0, y = TIC1, color = as.factor(macrostate)), stat = \u0026quot;ellipse\u0026quot;, inherit.aes = FALSE) + coord_cartesian() + facet_null() + #----map data values to visual values--- scale_x_continuous(name = \u0026quot;TIC-0\u0026quot;, breaks = -1:8) + scale_y_continuous(name = \u0026quot;TIC-1\u0026quot;, breaks = -6:3) + scale_color_discrete() + theme_classic() ggplot(energy_tics) + geom_point(mapping = aes(x = TIC0, y = TIC1, fill = Energy, shape = as.factor(macrostate)), stat = \u0026quot;identity\u0026quot;, position = \u0026quot;identity\u0026quot;, inherit.aes = FALSE) + geom_path(mapping = aes(x = TIC0, y = TIC1, color = as.factor(macrostate)), stat = \u0026quot;ellipse\u0026quot;, inherit.aes = FALSE) + coord_cartesian() + facet_null() + #----map data values to visual values--- scale_x_continuous(name = \u0026quot;TIC-0\u0026quot;, breaks = -1:8) + scale_y_continuous(name = \u0026quot;TIC-1\u0026quot;, breaks = -6:3) + scale_shape_manual(values = c(\u0026quot;1\u0026quot; = 22, \u0026quot;2\u0026quot; = 24, \u0026quot;3\u0026quot; = 23, \u0026quot;4\u0026quot; = 25)) + scale_fill_gradient(low = \u0026quot;blue\u0026quot;, high = \u0026quot;red\u0026quot;) + scale_color_discrete() + theme_classic()  "
},
{
	"uri": "/tutorials-4/network/",
	"title": "Network for graph-like data",
	"tags": [],
	"description": "",
	"content": " pre code, pre, code { white-space: pre !important; overflow-x: scroll !important; word-break: keep-all !important; word-wrap: initial !important; }  Import data transition = read.table(url(\u0026#39;https://raw.githubusercontent.com/MingChen0919/gst-colloquium-workshop-2018/master/content/datasets-2/John_datasets/transitionmatrix.dat\u0026#39;))  Load libraries library(ggnetwork) library(sna)  Simple network n = network(transition) n1 = ggnetwork(n) n1$x = n1$x[, 1] n1$y = n1$y[, 1] n1$xend = n1$xend[, 1] n1$yend = n1$yend[, 1] ggplot(n1, aes(x = x, y = y, xend = xend, yend = yend)) + geom_nodes() + geom_edges() + theme_blank()  Add attributes to vertices Assign an importance level to each vertex\nn %v% \u0026quot;importance\u0026quot; = sample(1:6, nrow(transition), replace = TRUE) Assign group to vertex\nn %v% \u0026quot;group\u0026quot; = sample(c(\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;), nrow(transition), replace = TRUE) Visualize group and importance informaction.\nn2 = ggnetwork(n) n2$x = n2$x[, 1] n2$y = n2$y[, 1] n2$xend = n2$xend[, 1] n2$yend = n2$yend[, 1] ggplot(n2, mapping = aes(x = x, y = y, xend = xend, yend = yend)) + geom_nodes(mapping = aes(color = group, size = importance)) + geom_edges() + theme_blank()  Adjust edges Edge transprancy\nggplot(n2, mapping = aes(x = x, y = y, xend = xend, yend = yend)) + geom_nodes(mapping = aes(color = group, size = importance)) + geom_edges(alpha = 0.05) + theme_blank() Threshold for edge display\nthreshold = 0.1 transition2 = transition transition2[transition2 \u0026lt; 0.1] = 0 n = network(transition2) n %v% \u0026quot;importance\u0026quot; = sample(1:6, nrow(transition), replace = TRUE) n %v% \u0026quot;group\u0026quot; = sample(c(\u0026quot;A\u0026quot;, \u0026quot;B\u0026quot;, \u0026quot;C\u0026quot;), nrow(transition), replace = TRUE) n1 = ggnetwork(n) n1$x = n1$x[, 1] n1$y = n1$y[, 1] n1$xend = n1$xend[, 1] n1$yend = n1$yend[, 1] ggplot(n1, mapping = aes(x = x, y = y, xend = xend, yend = yend)) + geom_nodes(mapping = aes(color = group, size = importance)) + geom_edges(alpha = 0.8) + theme_blank()  Add labels to nodes ggplot(n1, mapping = aes(x = x, y = y, xend = xend, yend = yend)) + geom_edges(alpha = 0.8) + geom_nodelabel(aes(label = vertex.names, color = as.factor(importance)), cex = 2, fontface = \u0026quot;bold\u0026quot;) + scale_color_manual(name = \u0026quot;Importance\u0026quot;, values = colorRampPalette(c(\u0026quot;yellow\u0026quot;, \u0026quot;red\u0026quot;))(6)) + theme_blank()  "
},
{
	"uri": "/ggplot2-framework-3/",
	"title": "ggplot2",
	"tags": [],
	"description": "",
	"content": " pre code, pre, code { white-space: pre !important; overflow-x: scroll !important; word-break: keep-all !important; word-wrap: initial !important; }  ggplot2 graph template   GEOM_FUNCTION: use a geometric object to represent your data.  MAPPINGS: associate data values with visual values. e.g., categorial data -\u0026gt; different colors. STAT: use raw data values or calculate new values from raw values. POSITION: adjust overlapped geometric objects.  COORDINATE_FUNCTION: type of coordinate systems. FACET_FUNCTION: divide plots into subplots SCALE_FUNCTION: how data values are mapped to visual values. THEME_FUNCTION: the apperance of graph components that is not directly related to the mappings.   "
},
{
	"uri": "/tutorials-4/",
	"title": "Data Visualization",
	"tags": [],
	"description": "",
	"content": " pre code, pre, code { white-space: pre !important; overflow-x: scroll !important; word-break: keep-all !important; word-wrap: initial !important; }  "
},
{
	"uri": "/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/",
	"title": "Data Visualization",
	"tags": [],
	"description": "",
	"content": "GST Data Visualization Team  Amanda Devolk Karthik Varanasi Jennifer Bourn Jiali Yu John Ossyra Ming Chen Pawat Pattarawat Rachel Steele Sanjeev Dahal Shawn Shen   "
},
{
	"uri": "/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]