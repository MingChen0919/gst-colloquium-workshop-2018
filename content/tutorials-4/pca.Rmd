---
weight: 2
title: "Scatterplot for PCA data"
author: "GST Data Visualization Group"
output: html_document
---

<style>
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



## Import data

```{r}
load(url('https://github.com/MingChen0919/gst-colloquium-workshop-2018/raw/master/content/datasets-2/datasets.RData'))
```

## Load libraries

```{r}
library(ggplot2)
```


## Visualization

### Collective Variables and Macrostates 

* **Geom object: point**
    + TIC0 -> x
    + TIC1 -> y
    + macrostate -> color

```{r}
ggplot(energy_tics) +
  geom_point(mapping = aes(x = TIC0, y = TIC1, color = as.factor(macrostate)),
             stat = "identity", 
             position = "identity") +
  coord_cartesian() +
  facet_null() +
  
  #----map data values to visual values---
  scale_x_continuous() +
  scale_y_continuous() +
  scale_color_identity() +
  
  theme()
  
```
```{r}
ggplot(energy_tics) +
  geom_point(mapping = aes(x = TIC0, y = TIC1, color = as.factor(macrostate)),
             stat = "identity", 
             position = "identity") +
  coord_cartesian() +
  facet_null() +
  
  ##----map data values to visual values---
  scale_x_continuous(name = "TIC-0", 
                     breaks = c(-1, 0, 1, 2, 3, 4, 5, 6, 7),
                     limits = c(-2, 10)) +
  scale_y_continuous(name = "TIC-1",
                     breaks = -6:3, 
                     trans = "reverse") +
  scale_color_manual(values = c("1" = "red", "2" = "blue", "3" = "yellow", "4" = "green"),
                     name = "Macrostate", 
                     breaks = c(1,2,3),
                     labels = c('state 1', 'state 2', 'state 3')) +
  
  theme_classic()
```



### Collective Variables, macrostate and Energy

* **Geom object: point**
    + TIC0 -> x
    + TIC1 -> y
    + macrostate -> shape
    + Energy -> color
    
```{r}
ggplot(energy_tics) +
  geom_point(mapping = aes(x = TIC0, y = TIC1, shape = as.factor(macrostate), color = Energy),
             stat = "identity", position = "identity") +
  coord_cartesian() +
  facet_null() +
  
  ##----map data values to visual values---
  scale_x_continuous() +
  scale_y_continuous() +
  scale_color_gradient() +
  scale_shape_discrete() +
  theme()
  
```

```{r}
ggplot(energy_tics) +
  geom_point(mapping = aes(x = TIC0, y = TIC1, shape = as.factor(macrostate), color = Energy),
             stat = "identity", position = "identity") +
  coord_cartesian() +
  facet_null() +
  
  ##----map data values to visual values---
  scale_x_continuous(name = "TIC-0",
                     breaks = -1:8) +
  scale_y_continuous(name = "TIC-1",
                     breaks = -6:3) +
  scale_color_gradient(low="blue", high="red",
                       breaks = 0:8) +
  scale_shape_manual(values = c("1" = 15, "2" = 17, "3" = 19, "4" = 22),
                     name = "Macrostate") +
  theme_classic()
```


## Confidence ellipse

* **Geom object: point**
    + TIC0 -> x
    + TIC1 -> y
    + macrostate -> shape
    + Energy -> color
    
* **Geom object: path**
    + TIC0 -> x
    + TIC1 -> y
    + macrostate -> color

```{r eval=FALSE}
ggplot(energy_tics) +
  geom_point(mapping = aes(x = TIC0, y = TIC1, color = Energy),
             stat = "identity", position = "identity", inherit.aes = FALSE) +
  geom_path(mapping = aes(x = TIC0, y = TIC1, color = as.factor(macrostate)), 
               stat = "ellipse", inherit.aes = FALSE) + 
  coord_cartesian() +
  facet_null() +
  
  #----map data values to visual values---
  scale_x_continuous(name = "TIC-0",
                     breaks = -1:8) +
  scale_y_continuous(name = "TIC-1",
                     breaks = -6:3) +
  scale_color_discrete() +
  theme_classic()
```


```{r}
ggplot(energy_tics) +
  geom_point(mapping = aes(x = TIC0, y = TIC1, fill = Energy, shape = as.factor(macrostate)),
             stat = "identity", position = "identity", inherit.aes = FALSE) +
  geom_path(mapping = aes(x = TIC0, y = TIC1, color = as.factor(macrostate)), 
               stat = "ellipse", inherit.aes = FALSE) + 
  coord_cartesian() +
  facet_null() +
  
  #----map data values to visual values---
  scale_x_continuous(name = "TIC-0",
                     breaks = -1:8) +
  scale_y_continuous(name = "TIC-1",
                     breaks = -6:3) +
  scale_shape_manual(values = c("1" = 22, "2" = 24, "3" = 23, "4" = 25)) +
  scale_fill_gradient(low = "blue", high = "red") +
  scale_color_discrete() +
  theme_classic()
```

