---
title: "Network Tutorial"
author: "Rachel Steele"
date: "February 15, 2018"
output: md_document
---



<style>
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}
</style>
<div id="loading-libraries" class="section level1">
<h1>Loading libraries</h1>
<pre class="r"><code>library(tidyr)
library(ggplot2)
library(reshape2)
library(GGally)
library(network)
library(sna)
library(scales)
library(reshape)</code></pre>
</div>
<div id="import-and-parse-data" class="section level1">
<h1>Import and parse data</h1>
<pre class="r"><code>data_path &lt;- &#39;../datasets/john_datasets/traj_0.dat&#39;
feature_names = stringr::str_split(readLines(data_path)[1], &#39;--&#39;)[[1]]

# feature names have space and special characters. These characters are not good for variable names.
# let&#39;s encode feature names
names(feature_names) = paste0(&#39;V_&#39;, 1:length(feature_names))
data_raw = read.table(data_path, header = FALSE, sep = &#39; &#39;, comment.char = &#39;D&#39;, stringsAsFactors = FALSE)
colnames(data_raw) = names(feature_names)
str(data_raw)

# add frame index
data_raw$frame_index = 1:nrow(data_raw)</code></pre>
</div>
<div id="network-plot" class="section level1">
<h1>Network plot</h1>
<pre class="r"><code>#convert data to adjacency matrix
#lookup table from feature to frame index
feature_to_frame &lt;- data_raw$frame_index
names(feature_to_frame) &lt;- data_raw$V_1

#normalize
data_melt &lt;- melt(data_raw, id=c(&quot;frame_index&quot;, &quot;V_1&quot;))

#remap feature to frame index
map &lt;- data.frame(src=data_melt$frame_index, dest=feature_to_frame[as.character(data_melt$value)])

#convert to adjacency matrix
adj_matrix &lt;- xtabs(~ src + dest, map)

#convert xtabs format to matrix
attr(adj_matrix, &quot;class&quot;) &lt;- NULL
attr(adj_matrix, &quot;call&quot;) &lt;- NULL

#convert matrix to data.frame
df_adj&lt;- as.data.frame(adj_matrix)

#These formats (xtabs, matrix, and data.frame) don&#39;t seem to be working with ggnet2
#will keep on trying to troubleshoot later
ggnet2(df_adj)</code></pre>
</div>
